---
title: テスト結果の理解
seo-title: テスト結果の理解
description: 'null'
seo-description: このページでは、パイプライン実行中の 3 層ゲート、Cloud Manager でプログラムを検証するコードスキャンテスト、パフォーマンステストおよびセキュリティテストについて説明します。
uuid: 93caa01f-0df2-4a6f-81dc-23dfee24dc93
contentOwner: jsyal
products: SG_EXPERIENCEMANAGER／CLOUDMANAGER
topic-tags: 使用
discoiquuid: 83299ed8-4b7a-4b1c-bd56-1bfc7e7318d4
translation-type: tm+mt
source-git-commit: 1dfb065c09569f811e5a006d3d74825d3bd7cc8d

---


# テスト結果の理解 {#understand-your-test-results}

**パイプライン**プロセス中は、多数の指標が取得され、ビジネスオーナーによって定義された主要業績評価指標（KPI）または Adobe Managed Services で設定された標準と比較されます。

これらは、この節で定義する 3 層ゲートシステムを使用して報告されます。

## パイプライン実行中の 3 層ゲート {#three-tier-gates-while-running-a-pipeline}

パイプラインには次の 3 つのゲートがあります。

* コード品質
* パフォーマンステスト
* セキュリティテスト

これらの各ゲートで特定された問題には、3 段階の構造があります。

* **重大** - ゲートで特定される問題のうち、パイプラインの即時失敗につながるもの。
* **重要** - ゲートで特定される問題のうち、パイプラインの一時停止につながるもの。デプロイメントマネージャー、プロジェクトマネージャーまたはビジネスオーナーは、問題をオーバーライドできます。この場合、パイプラインは続行されます。または、問題を承認できます。この場合、パイプラインはエラーで停止します。
* **情報** - ゲートで特定される問題のうち、情報提供だけを目的とするもの。パイプラインの実行には影響しません。

## コード品質テスト {#code-quality-testing}

パイプラインの一環として、ソースコードをスキャンし、デプロイメントが特定の品質条件を満たしているかどうかを確認します（現在は SonarQube で実装されています）。汎用の Java ルールと AEM 固有のルールを組み合わせた 100 以上のルールがあります。テスト条件の評価の概要を次の表に示します。

| 名前 | 定義 | カテゴリ | 不合格のしきい値 |
|--- |--- |--- |--- |
| セキュリティ評価 | A = 脆弱性なし <br/>B = 軽度の脆弱性が 1 つ以上<br/>C = 重要な脆弱性が 1 つ以上 <br/>C = の重大な脆弱性が 1 つ以上 <br/>E = 致命的な脆弱性が 1 つ以上 | 重大 | &lt; B |
| 信頼性評価 | A = バグなし <br/>B = 軽度のバグが 1 つ以上 <br/>C = 重要なバグが 1 つ以上 <br/>D = 重大なバグが 1 つ以上 E = 致命的なバグが 1 つ以上 | 重要 | &lt; C |
| 保守性評価 | コードスメルに対する未処理の修正コスト：<br/><ul><li>&lt;=5%の時間の中で既にアプリケーションに到達しているか、評価はA </li><li>上記時間の 6 ～ 10% であれば、評価は B </li><li>上記時間の 11 ～ 20% であれば、評価は C </li><li>上記時間の 21 ～ 50% であれば、評価は D</li><li>上記時間の 50% を超えれば、評価は E</li></ul> | 重要 | &lt; A |
| カバレッジ | この数式を使用した単位テストと条件範囲の組み合わせの混合: <br/>`Coverage = (CT + CF + LC)/(2*B + EL)`<br/>次のように指定します。UNT=条件の実行中に少なくとも1回、&quot;false&quot;に評価された、数量テスト <br/>の実行中に&quot;false&quot;に評価されたCT=条件の問題を修正しました。 <br/>LC= contained lines= lines_ to_ recipe- unwatched_ lines <br/><br/> B= total number of Condiabilities <br/>line（lines_ to_ over） | 重要 | &lt; 50% |
| スキップした単体テスト | スキップした単体テストの数。 | 情報 | &gt; 1 |
| 未解決の問題 | 問題の全体的なタイプ - 脆弱性、バグ、コードスメル | 情報 | &gt; 1 |
| 重複行 | 重複しているブロックに含まれている行の数。<br/>コードブロックが重複していると見なされるための条件：<br/><ul><li>**Java 以外のプロジェクトの場合：**</li><li>100 個以上の連続した重複トークンが必要です。</li><li>これらのトークンは、少なくとも次の場所に分散している必要があります。 </li><li>30 行の COBOL コード </li><li>20 行の ABAP コード </li><li>10 行の他言語コード</li><li>**Java プロジェクトの場合：**</li><li> トークンと行の数に関わらず、10 個以上の連続した重複ステートメントが必要です。</li></ul> <br/>重複を検出する際は、インデントの違いと文字列リテラルの違いは無視されます。 | 情報 | &gt; 1% |


>[!NOTE]
>
>[詳細な定義については、指標の定義](https://docs.sonarqube.org/display/SONAR/Metric+Definitions) を参照してください。


ここでルールの一覧 [sonarqube-rules.xlsx](assets/sonarqube-rules.xlsx) をダウンロードできます。

>[!NOTE]
>
>[!UICONTROL Cloud Manager] で実行されるカスタム SonarQube ルールについて詳しくは、[カスタムコード品質ルール](custom-code-quality-rules.md)を参照してください。

### 偽陽性の処理 {#dealing-with-false-positives}

品質スキャンプロセスは完璧ではなく、実際には問題がないにもかかわらず問題として誤って特定することもあります。これは「偽陽性」と呼ばれます。

この場合、ルール ID を注釈属性として指定した標準の Java `@SuppressWarnings` 注釈を使用して、ソースコードに注釈を付けることができます。例えば、よくある問題の 1 つとして、ハードコードされたパスワードを検出する SonarQube ルールにおいて、ハードコードされたパスワードの識別方法が強引な場合があります。

具体的な例を見てみましょう、次のコードは、一部の外部サービスに接続するコードを含んだ AEM プロジェクトではかなり一般的なものです。

```java
@Property(label = "Service Password")
private static final String PROP_SERVICE_PASSWORD = "password";
```

この場合、SonarQube は致命的脆弱性を報告します。コードを見直した後、これが脆弱性でないことを確認し、適切なルール ID でこれに注釈を付けることができます。

```java
@SuppressWarnings("squid:S2068")
@Property(label = "Service Password")
private static final String PROP_SERVICE_PASSWORD = "password";
```

一方、コードが実際には次のようになっていた場合は、

```java
@Property(label = "Service Password", value = "mysecretpassword")
private static final String PROP_SERVICE_PASSWORD = "password";
```

ハードコードされたパスワードを削除するのが正しい解決策です。

>[!NOTE]
>
>`@SuppressWarnings` 注釈をできるだけ具体的にすることをお勧めします。つまり、問題の原因となっている特定のステートメントまたはブロックにのみ注釈を付けます。ただし、クラスレベルで注釈を付けることもできます。

## セキュリティテスト {#security-testing}

[!UICONTROL Cloud Manager] では、デプロイメント後に既存の ***AEM セキュリティヘルスチェック***を実行し、UI を通じてそのステータスを報告します。結果は、環境内のすべての AEMインスタンスから集計されます。

いずれかの**インスタンス**が特定のヘルスチェックに対して不合格を報告した場合、**環境**全体がそのヘルスチェックに対して不合格となります。コード品質テストやパフォーマンステストと同様に、これらのヘルスチェックもいくつかのカテゴリにまとめられ、3 層ゲートシステムを使用して報告されます。セキュリティテストの場合にはしきい値がない点だけが異なります。すべてのヘルスチェックでは、単純に合格または不合格のみの結果になります。

現在のチェックの一覧を次の表に示します。

| **名前** | **ヘルスチェックの実装** | **カテゴリ** |
|---|---|---|
| デシリアライゼーションファイアウォールAttach API Readiness is an acceptable state | デシリアライゼーションファイアウォール添付 API レディネス | 重大 |
| デシリアライゼーションファイアウォールの機能 | デシリアライゼーションファイアウォール機能 | 重大 |
| デシリアライゼーションファイアウォールが読み込まれる | デシリアライゼーションファイアウォール読み込み | 重大 |
| authorizableNodeName実装では、ノード名/パスに許可可能なIDが公開されません。 | 認証可能なノード名生成 | 重大 |
| デフォルトのパスワードが変更されました | デフォルトのログインアカウント | 重大 |
| Sling default GETサーブレットはDOS攻撃から保護されています。 | Sling Get Servlet | 重大 |
| ディスパッチャーがリクエストを適切にフィルタリングしている | CQ Dispatcher 設定 | 重大 |
| Adobe Granite HTMLライブラリマネージャーは適切に設定されている | CQ HTML ライブラリマネージャー設定 | 重大 |
| Sling Java Script Handlerは適切に設定されています | Sling Java Script Handler | 重大 |
| Sling JSPスクリプトハンドラーは適切に設定されます | Sling JSP Script Handler | 重大 |
| Slingリファラーフィルターは、CSRF攻撃を防ぐために設定されます | Sling Referrer Filter | 重大 |
| SSLが正しく設定されている | SSL 設定 | 重大 |
| 明らかに安全でないユーザープロファイルポリシーが見つかりませんでした | ユーザープロファイルへのデフォルトアクセス | 重大 |
| CRXDE サポートバンドルは無効です | CRXDE サポート | 重要 |
| Sling DavExバンドルおよびサーブレットは無効です | DavEx ヘルスチェック | 重要 |
| サンプルコンテンツがインストールされていません | サンプルコンテンツパッケージ | 重要 |
| WCMリクエストフィルターとWCMデバッグフィルターの両方が無効になっています | WCM フィルター設定 | 重要 |
| Sling WebDAVバンドルおよびサーブレットは適切に設定されている | WebDAV ヘルスチェック | 重要 |
| クリックジャッキングを防止するためにWebサーバーが設定されている | Web サーバー設定 | 重要 |
| レプリケーションで&quot;admin&quot;ユーザーを使用していません | レプリケーションとトランスポートユーザー | 情報 |

## パフォーマンステスト {#performance-testing}

[!UICONTROL Cloud Manager] の*パフォーマンステスト*は、30 分間のテストを使用して実装されます。

パイプラインの設定中に、デプロイメントマネジャーは各バケットに送るトラフィックの量を決定できます。

バケット制御について詳しくは、[CI／CD パイプラインの設定](configuring-pipeline.md)を参照してください。

>[!NOTE]
>
>プログラムを設定し KPI を定義するには、[プログラムの設定](setting-up-program.md)を参照してください。

3 層ゲートシステムを使用したパフォーマンステストマトリックスの概要を次の表に示します。

| **指標** | **カテゴリ** | **不合格のしきい値** |
|---|---|---|
| ページリクエストエラー率 % | 重大 | &gt;= 2% |
| CPU 使用率 | 重大 | &gt;= 80% |
| ディスク I/O 待機時間 | 重大 | &gt;= 50% |
| 第 95 百分位応答時間 | 重要 | &gt;= プログラムレベルの KPI |
| ピーク応答時間 | 重要 | &gt;= 18 秒 |
| 1 分あたりのページビュー数 | 重要 | &lt; プログラムレベルの KPI |
| ディスク帯域幅使用量 | 重要 | &gt;= 90% |
| ネットワーク帯域幅使用量 | 重要 | &gt;= 90% |
| 1 分あたりのリクエスト数 | 情報 | &lt; 6000 |

### パフォーマンステスト結果のグラフ {#performance-testing-results-graphs}

パフォーマンステスト結果ダイアログに、新しいグラフおよびダウンロードオプションが追加されました。

パフォーマンステストダイアログを開いた場合、指標パネルを展開して、グラフやダウンロードへのリンクを表示することができます。

[!UICONTROL Cloud Manager] リリース 2018.7.0 の場合、この機能は次の指標で利用できます。

* **CPU 使用率**
   * テスト期間中の CPU 使用率のグラフ。

* **ディスク I/O 待機時間**
   * テスト期間中のディスク I/O 待機時間のグラフ。

* **ページエラー率**
   * テスト期間中の 1 分あたりのページエラー数のグラフ。
   * テスト中にエラーが発生したページの一覧を示す CSV ファイル。

* **ディスク帯域幅使用量**
   * テスト期間中のディスク帯域幅使用量のグラフ。

* **ネットワーク帯域幅使用量**
   * テスト期間中のネットワーク帯域幅使用量のグラフ。

* **ピーク応答時間**
   * テスト期間中の 1 分あたりのピーク応答時間のグラフ。

* **第 95 百分位応答時間**
   * テスト期間中の 1 分あたりの第 95 百分位応答時間のグラフ。
   * 第 95 百分位応答時間が定義済みの KPI を超えたページの一覧を示す CSV ファイル。

パフォーマンステストグラフの表示例を次の図に示します。

![](assets/understand_test-results-screen1.png)

![](assets/screen_shot_2018-09-05at83933pm.png)

