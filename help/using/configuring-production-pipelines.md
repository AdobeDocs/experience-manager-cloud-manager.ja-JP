---
title: 実稼動パイプラインの設定
description: Cloud Manager を使用して、コードをデプロイするための実稼動パイプラインを作成および設定する方法について説明します。
uuid: 35fd56ac-dc9c-4aca-8ad6-36c29c4ec497
products: SG_EXPERIENCEMANAGER/CLOUDMANAGER
topic-tags: using
content-type: reference
discoiquuid: ba6c763a-b78a-439e-8c40-367203a719b3
feature: CI-CD Pipeline
exl-id: d489fa3c-df1e-480b-82d0-ac8cce78a710
source-git-commit: 205113735cc743e11e140b1161413002844f5b79
workflow-type: ht
source-wordcount: '1557'
ht-degree: 100%

---

# 実稼動パイプラインの設定 {#configuring-production-pipelines}

Cloud Manager を使用して、コードをデプロイするための実稼動パイプラインを作成および設定する方法について説明します。最初に、Cloud Manager でのパイプラインの動作に関する概念的な概要については、[CI／CD パイプラインの概要ドキュメント](ci-cd-pipeline.md)を参照してください。

>[!NOTE]
>
>AEM as a Cloud Service で Cloud Manager 用に CI／CD パイプラインを設定する方法については、[AEMaaCS のドキュメント](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/implementing/using-cloud-manager/configure-pipeline.html?lang=ja#using-cloud-manager)を参照してください。

## 概要 {#understanding-the-flow}

パイプラインは、[!UICONTROL Cloud Manager] UI の「**パイプライン設定**」タイルから設定できます。

2 つの異なるタイプのパイプラインを作成できます。

* **実稼動パイプライン** - 実稼動パイプラインは、ソースコードを最終的に実稼動環境に取り込むために調整された一連のステップで構成される専用のパイプラインです。
* **実稼動以外のパイプライン** - 実稼動以外のパイプラインは、コード品質スキャンの実行または開発環境へのソースコードのデプロイを目的としています。

このドキュメントでは、実稼動パイプラインに焦点を当てます。実稼動以外のパイプラインの設定方法について詳しくは、[実稼動以外のパイプラインの設定](configuring-non-production-pipelines.md)のドキュメントを参照してください。

**デプロイメントマネージャー**&#x200B;の役割は、パイプラインを設定することです。パイプライン設定は以下で構成されます。

1. パイプラインを開始するトリガーの定義。
1. 実稼動デプロイメントを制御するパラメーターの定義。
1. パフォーマンステストパラメーターの設定。

>[!NOTE]
>
>パイプラインは、関連する Git リポジトリが少なくとも 1 つの分岐を持ち、[プログラム設定](setting-up-program.md)が完了するまで、設定できません。

>[!NOTE]
>
>初期設定後にパイプライン設定を変更できます。

## ビデオチュートリアル {#video-tutorial-one}

パイプライン作成プロセスの概要については、このビデオをご覧ください。

>[!VIDEO](https://video.tv.adobe.com/v/26314/)

## 新しい実稼動パイプラインの追加 {#adding-production-pipeline}

[!UICONTROL Cloud Manager] UI を使用してプログラムを設定し、少なくとも 1 つの環境を用意したら、実稼動パイプラインを追加する準備が整います。

1. [my.cloudmanager.adobe.com](https://my.cloudmanager.adobe.com/) で Cloud Manager にログインし、適切な組織とプログラムを選択します。

1. **プログラムの概要**&#x200B;ページから&#x200B;**パイプライン**&#x200B;カードに移動し、「**+ 追加**」をクリックして「**実稼動パイプラインを追加**」を選択します。

   ![実稼動パイプラインを追加](/help/using/assets/configure-pipelines/add-prod1.png)

1. **実稼動パイプラインを追加**&#x200B;ダイアログボックスが開き、「**設定**」タブが開きます。このタブでは、パイプラインに対する複数のオプションを定義する必要があります。これらのオプションは折りたたみ可能なセクションにグループ化されています。次の手順で説明します。

   1. 「**パイプライン名**」フィールドに、パイプラインのわかりやすい名前を指定します。

   1. 「**ソースコード**」セクションで、パイプラインが処理するコードを取得する場所を定義します。

      * **リポジトリ** - このオプションは、パイプラインがコードを取得する Git リポジトリを定義します。
      >[!TIP]
      >
      >Cloud Manager でリポジトリを追加および管理する方法については、[プログラムの設定](setting-up-program.md)のドキュメントを参照してください。

      * **Git ブランチ** - このオプションは、選択したパイプラインのどのブランチからコードを取得するかを定義します。
      * **コードの場所** - このオプションは、パイプラインがコードを取得する必要がある、選択したリポジトリのブランチ内のパスを定義します。

      ![パイプラインのリポジトリを定義](/help/using/assets/configure-pipelines/add-prod2.png)

   1. 「**環境**」セクションでは、デプロイメントをトリガーするものと、環境ごとのロールアウト方法を定義します。

      1. 「**ステージ**」セクションでは、パイプラインをステージング環境にロールアウトする方法を定義できます。

         * **デプロイメントトリガー** - 次のオプションで、パイプラインを開始するデプロイメントトリガーを定義できます。

            * **手動** - このオプションは、Cloud Manager UI を使用してパイプラインを手動で開始する場合に使用します。
            * **Git の変更時** - このオプションは、設定された Git ブランチにコミットが追加されるたびに CI／CD パイプラインを開始します。このオプションを使用すると、必要に応じてパイプラインを手動で開始できます。
         * **重要な指標のエラー動作** - パイプラインの設定または編集中に、デプロイメントマネージャーには、品質ゲートのいずれかで重要なエラーが発生した場合のパイプラインの動作を定義するオプションがあります。使用できるオプションは以下のとおりです。

            * **毎回確認する** - デフォルトの設定。重要なエラーが検出されたときに手動で介入する必要があります。
            * **直ちに失敗** - 重要なエラーが検出されると、パイプラインはキャンセルされます。このオプションでは、基本的に、各エラーをユーザーが手動で拒否する状況をエミュレートします。
            * **直ちに続行** - 重要なエラーが検出されても、パイプラインは自動的に続行されます。このオプションでは、基本的に、各エラーをユーザーが手動で承認する状況をエミュレートします。

         ![デプロイメントトリガー](/help/using/assets/configure-pipelines/add-prod3.png)

         * **デプロイメントオプション** - 特定のデプロイメントタスクを高速化できます。

            * **ステージデプロイメント後に承認** - この承認は、テストが行われる前にステージング環境へのデプロイメント後に発生します。それ以外の場合は、すべてのテストが完了した後、実稼動のデプロイメントの前に承認が行われます。

            * **ロードバランサーの変更をスキップ** - ロードバランサーの変更は行われません。

         ![ステージングデプロイメントオプション](/help/using/assets/configure-pipelines/add-prod4.png)

         * **Dispatcher 設定** - **デプロイメントマネージャー**&#x200B;の役割は、パイプラインの実行時に AEM Dispatcher キャッシュから無効化またはフラッシュされる一連のコンテンツパスを設定できます。これらのキャッシュアクションは、コンテンツパッケージがデプロイされた直後に、デプロイメントパイプラインステップの一部として実行されます。これらの設定では、AEM Dispatcher の標準的な動作を使用します。次の手順で設定します。

            1. 「**パス**」で、コンテンツパスを指定します。
            1. 「**種類**」で、そのパスに対して実行するアクションを選択します。
            * **フラッシュ** - コンテンツがオーサーインスタンスからパブリッシュインスタンスに対してアクティベートされる場合と同様に、キャッシュの無効化を実行します。
            * **無効化** - キャッシュの削除を実行します。
            1. 「**パスを追加**」をクリックして、指定したパスを追加します。環境につき最大 100 個のパスを追加できます。

         ![Dispatcher 設定](/help/using/assets/configure-pipelines/dispatcher-stage.png)

         >[!TIP]
         >
         >一般に、無効化アクションを使用する方が望ましいですが、フラッシュが必要な場合もあります（特に、AEM HTML クライアントライブラリを使用する場合など）。

      1. 「**実稼動**」セクションでは、パイプラインが実稼動環境にどのようにロールアウトされるかを定義できます。

         * **デプロイメントオプション** - 実稼動デプロイメントを制御するパラメーターを定義できます。

            * **GoLive の承認を使用** - [!UICONTROL Cloud Manager UI] を使用して、**ビジネスオーナー**、**プロジェクトマネージャー**、**デプロイメントマネージャー**&#x200B;のいずれかの役割を持つユーザーがデプロイメントを手動で承認する必要があります。
            * **スケジュール設定** - このオプションは、実稼動デプロイメントの前にパイプラインを停止し、スケジュールできるようにします。このオプションを選択した場合、パイプラインはステージング環境へのデプロイメント後に停止し、実行するアクションをユーザーに促します。
               * **今すぐ** - このオプションは、実稼動環境に即座にデプロイされ、パイプラインを効果的に完了します。
               * **日付** - このオプションを使用すると、ユーザーはデプロイメントを完了する時刻をスケジュールできます。
               * **実行を停止** - このオプションは、実稼動環境へのデプロイメントを中止します。

            >[!TIP]
            >
            >デプロイメントスケジュールを設定する方法やパイプラインをすぐに実行する方法については、[コードのデプロイ](deploying-code.md)のドキュメントを参照してください。

            * **CSE Oversight を使用** - このオプションを選択すると、CSE が実際にデプロイメントを開始します。このオプションが有効な場合、パイプラインの作成または編集時に、**デプロイメントマネージャー**&#x200B;の役割には次のオプションがあります。

               * **任意の CSE** - このオプションを使用すると、利用可能な任意の CSE がデプロイメントを開始できます。
               * **担当の CSE** - このオプションを使用すると、顧客に割り当てられた特定の CSE のみがデプロイメントを開始できます。これは、割り当てられた CSE が使用できない場合に、CSE の指定されたバックアップにも当てはまります。

            ![実稼動デプロイメントオプション](/help/using/assets/configure-pipelines/prod-deploymentoptions.png)

         * **Dispatcher 設定** - 実稼動環境の Dispatcher 設定を定義します。オプションは、ステージング環境のオプションと同じです。











1. 「**続行**」をクリックして「**ステージテスト**」タブに進み、ライセンスを取得した製品に応じて、AEM Sites と AEM Assets のパフォーマンステストを設定できます。

   >[!TIP]
   >
   >「**ステージテスト**」タブで使用できるオプションについて詳しくは、[テスト結果について](understand-your-test-results.md#performance-testing)のドキュメントを参照してください。

   1. 「**サイトコンテンツ配信 / 負荷分散**」セクションでは、3 つのページセット間でのページリクエストの重み付けに基づいて、サイトのパフォーマンステストをどのように設定するかを定義します。この重み付けは、有効または無効にできます。

      * **頻度の高いライブページ**
      * **その他のライブページ**
      * **新規ページ**

      ![サイトの読み込みの重み付け](/help/using/assets/configure-pipelines/add-prod5.png)

   1. 「**アセットパフォーマンステスト配布**」セクションでは、画像と PDF のテスト配布を定義し、独自のテストアセットを定義します。

      * **画像** - スライダーを調整して、画像と PDF 間のテスト分割を調整します。
      * **PDF** - スライダーを調整して、画像と PDF の間でテストの分割を調整します。

      * 独自のカスタムアセットをアップロードして定義します。

         1. **フォーマット** - カスタムアセットが画像の PDF かどうかを選択します。
         1. **ファイル名** - ファイルブラウザーボタンを使用して、ローカルマシンから画像を選択します。
         1. **テストファイルを追加** - クリックして、選択したアセットをアップロードします。

      ![アセットテスト配布](/help/using/assets/configure-pipelines/add-prod6.png)



1. 「**保存**」をクリックして、実稼動パイプラインの追加を完了します。














### 実稼動パイプラインの編集 {#editing-prod-pipeline}

**プログラムの概要**&#x200B;ページでパイプライン設定を編集できます。

設定済みのパイプラインを編集するには、次の手順に従います。

1. **プログラムの概要**&#x200B;ページから&#x200B;**パイプライン**&#x200B;カードに移動します。

1. **パイプライン**&#x200B;カードの「**...**」をクリックし、「**編集**」をクリックします（下図を参照）。

   ![](/help/using/assets/configure-pipelines/edit-prod1.png)

1. **実稼動パイプラインを編集**&#x200B;ダイアログボックスが表示されます。

   1. 「**設定**」タブでは、「**パイプライン名**」、「**リポジトリー**」、「**Git ブランチ**」、「**デプロイメントトリガー**」、「**重要な指標のエラー動作**」、「**デプロイメントオプション**」および「**Dispatcher 設定**」を更新できます。

      >[!NOTE]
      >Cloud Manager でリポジトリーを追加および管理する方法については、[リポジトリーの追加と管理](/help/using/cloud-manager-repositories.md)を参照してください。


   1. 「**ステージテスト**」タブでは、**サイトコンテンツ配信 / 負荷分散**&#x200B;と&#x200B;**アセットパフォーマンステスト配布**&#x200B;のオプションを再選択できます。

1. パイプラインの編集が完了したら、「**更新**」をクリックします。

### 実稼動パイプラインに対するその他のアクション {#additional-prod-actions}

#### 実稼動パイプラインの実行 {#run-prod}

パイプラインカードから実稼動パイプラインを実行できます。

1. **プログラムの概要**&#x200B;ページから&#x200B;**パイプライン**&#x200B;カードに移動します。

1. **パイプライン**&#x200B;カードの「**...**」をクリックし、「**実行**」をクリックします（下図を参照）。

   ![](/help/using/assets/configure-pipelines/prod-run.png)

#### 実稼動パイプラインの削除 {#delete-prod}

パイプラインカードから実稼動パイプラインを削除できます。

1. **プログラムの概要**&#x200B;ページから&#x200B;**パイプライン**&#x200B;カードに移動します。

1. **パイプライン**&#x200B;カードの「**...**」をクリックし、「**削除**」をクリックします（下図を参照）。

   ![](/help/using/assets/configure-pipelines/prod-delete.png)

   >[!NOTE]
   >デプロイメントマネージャーの役割を持つユーザーが、パイプラインカードの「**削除**」オプションを使用して、セルフサービスｓで実稼動パイプラインを削除できるようになりました。

